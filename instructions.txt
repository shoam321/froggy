instructions for Co pilot
System Rules & Development Guidelines
"For all code generation and architectural advice regarding this project, you must adhere to these rules at all times:"

1. UI/UX Principles (Fluent Design)
Design Tokens Only: Never use hardcoded colors (e.g., #FFFFFF). Always use Windows 11 Theme Resources (e.g., {ThemeResource LayerOnMicaBaseAltFillColorDefaultBrush}).

Materials & Depth: Every window must use MicaAlt. Every interactive element must have a defined Elevation (Shadow) and CornerRadius (default to 8px or 12px for cards).

Motion First: Do not provide static UI code. Include VisualStateManager states for PointerOver, Pressed, and Focused for every custom control.

2. Architecture & Pattern (Clean MVVM)
Strict MVVM: No logic in Code-Behind (xaml.cs). All data manipulation and command handling must be in the ViewModel.

Modern C#: Use Source Generators from the Community Toolkit (attributes like [ObservableProperty], [RelayCommand], and [ObservableObject]).

Asynchronous Integrity: Every hardware-related call (Bluetooth/GATT) must be async. Never use .Result or .Wait(); use await to prevent UI thread freezing.

3. Bluetooth & Hardware Management
Battery Specification: Always target GATT Service UUID 0x180F and Characteristic UUID 0x2A19.

Notification Over Polling: Always attempt to subscribe to Characteristic.ValueChanged first. Only fallback to manual polling if the device doesn't support notifications.

Power Efficiency: When the app is minimized or the window is hidden, hardware scanning and GATT listeners must be throttled or paused.

4. Error & State Handling
Defensive Coding: Every Bluetooth connection must be wrapped in try-catch blocks specifically handling DeviceUnreachable and AccessDenied exceptions.

User Feedback: For every background task, include a bool IsLoading property in the ViewModel to drive a ProgressRing or "shimmer" effect in the UI.

Empty States: Never show an empty screen. Provide a 'No Devices Found' view with a 'Scan' button.

5. Code Documentation
Self-Documenting Code: Use descriptive variable names (e.g., batteryLevelPercentage instead of bat).

XML Comments: Provide <summary> tags for all public methods explaining the 'why' behind hardware calls.

6. Edit Safety & Approval (MANDATORY)

Edit Policy — No Unapproved Actions:
- Never modify source files or apply patches without an explicit, written approval from the repository owner or designated reviewer.
- For any requested change, present a concise plan (what will change and why), a small human-reviewable patch, and wait for confirmation before applying.

Pre-Edit Checklist:
- Create a readable patch or diff and include affected file paths and a short rationale.
- Produce an automated backup copy for any file that will be changed (e.g., save to `backups/<timestamp>/path/to/file`).
- Add or update a TODO item in the project's tracker before making changes.

Interaction & Tool Use Rules:
- When using automated tools (build, tests, patch application, package manager) explicitly notify the user of the exact commands to be run and wait for approval to execute them.
- Do not run or publish builds, tests, or installers without explicit permission.
- Do not launch application executables on the user's machine without permission.

Rollback & Recovery:
- If an unintended change is applied, immediately stop further actions and revert using one of the following, in order of preference:
	1) Restore from the most recent backup copy in `backups/`.
	2) If the repo uses git, run: `git restore --source=HEAD --staged --worktree -- .` (owner must confirm).
	3) If a commit was pushed, prepare a revert patch and ask the owner for confirmation to apply it.

Communications & Transparency:
- Provide short, clear preambles before any batch of automated actions explaining the objective and expected outcome (one sentence).
- Log every automated step into `edit_log.txt` with timestamp, files changed, who authorized it, and a short reason.

Enforcement:
- Any automated agent or collaborator that fails to follow these rules must be suspended from making automated changes until a human reviews and re-authorizes it.

Appendix — Quick Authorization Template (copy and paste to approve a change):
"I approve the following change: [short description]. Proceed to apply the patch to: [files]. Backup to: [backup path]."
